---
layout: post
title:  "初识NuttX操作系统"
categories: "drons_lifes"
author: nephne
tags: 工作生活
comments: true
---
这篇文章主要记录学习NuttX的过程以及对NuttX的理解。

NuttX Operating System User's Manual
===

[NuttX Operating System User's Manual](http://nuttx.org/doku.php?id=documentation:userguide)从软件开发者的视角为NuttX提供一般的使用信息。

NSH 启动脚本
===

NSH 启动脚本。NSH支持选项来为NSH提供一个启动脚本。一般来说这种能力是用config_nsh_romfsetc启用，但有几个相关的描述NSH特定配置设置的配置选项。这种能力还取决于：

* CONFIG_DISABLE_MOUNTPOINT 未设置
* CONFIG_NFILE_DESCRIPTORS > 4
* CONFIG_FS_ROMFS 使能

默认启动行为。所提供的实施旨在为启动文件的使用提供极大的灵活性。本段将讨论所有配置选项设置为默认值时的一般行为。


在默认情况下，使能CONFIG_NSH_ROMFSETC将导致NSH在启动时表现如下：

* NSH将创建一个只读的内存盘（ROM盘），含有一个微小的romfs文件系统包含以下：

				`--init.d/
				     `-- rcS
rcS是NSH启动脚本。

* NSH将装入romfs文件系统到/etc，导致：

				|--dev/
				|   `-- ram0
				`--etc/
				    `--init.d/
				        `-- rcS

* 默认情况下，rcS脚本的内容：

				# Create a RAMDISK and mount it at XXXRDMOUNTPOINTXXX

				mkrd -m 1 -s 512 1024
				mkfatfs /dev/ram1
				mount -t vfat /dev/ram1 /tmp

* NSH将在/etc/init.d/rcS启动时执行脚本(在第一个NSH提示前)。脚本执行后，根文件将看起来像：

				|--dev/
				|   |-- ram0
				|   `-- ram1
				|--etc/
				|   `--init.d/
				|       `-- rcS
				`--tmp/

修改ROMFS镜像。/etc目录的内容保留在文件apps/nshlib/nsh_romfsimg.h里，或者如果定义了CONFIG_NSH_ARCHROMFS，包含/arch/board/rcs.template。为了修改启动行为，有三件事情要学习：

1. 配置选项。